<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
  <title>Product Categories - Damodar Traders</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: #333;
      background-color: #f9f9f9;
      overflow-x: hidden;
    }
    
    nav {
      height: 70px;
      width: 100%;
      display: flex;
      align-items: center;
      position: sticky;
      top: 0;
      left: 0;
      justify-content: space-between;
      background-color: #ffffff;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      z-index: 999;
      padding: 0 15px;
    }

    nav > ul {
      display: flex;
      align-items: center;
      font-size: 16px;
      gap: 20px;
      list-style: none;
    }

    nav img {
      width: 150px;
      height: auto;
    }

    /* Mobile menu button */
    .mobile-menu-btn {
      display: none;
      background: none;
      border: none;
      color: #333;
      font-size: 24px;
      cursor: pointer;
      padding: 10px;
      z-index: 1000;
    }

    .nav-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 998;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .nav-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    a {
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      color: #333;
      padding: 8px 16px;
    }

    .nav-product {
      display: flex;
      align-items: center;
      position: relative;
    }
    
    .nav-product svg {
      margin-left: 5px;
      width: 18px;
      height: 18px;
      transition: transform 0.3s;
    }
    
    .product-dropdown {
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
      background: white;
      min-width: 200px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      border-radius: 8px;
      padding: 8px 0;
      z-index: 1000;
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.3s, transform 0.3s;
    }
    
    .nav-product:hover .product-dropdown,
    .product-dropdown:hover {
      display: block;
      opacity: 1;
      transform: translateY(0);
    }
    
    .nav-product:hover svg {
      transform: rotate(180deg);
    }
    
    .product-dropdown a {
      display: block;
      padding: 10px 20px;
      color: #555;
      font-size: 14px;
      transition: all 0.2s;
      text-align: left;
      justify-content: flex-start;
    }
    
    .product-dropdown a:hover {
      background: #f5f5f5;
      color: #2a5f8a;
      padding-left: 25px;
    }
    
    .line {
      border: none;
      height: 1px;
      background-color: #eee;
      margin: 0;
    }
    
    .main {
      padding: 0 5%;
      max-width: 1400px;
      margin: 0 auto;
    }
    
    .categories-header {
      text-align: center;
      padding: 40px 0;
    }
    
    .categories-header h1 {
      font-size: clamp(2rem, 5vw, 2.5rem);
      margin-bottom: 15px;
      color: #222;
      line-height: 1.2;
    }
    
    .categories-header p {
      color: #666;
      max-width: 700px;
      margin: 0 auto;
      font-size: clamp(1rem, 2vw, 1.1rem);
      line-height: 1.6;
    }
    
    .category-section {
      margin: 40px 0;
      padding: 20px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.05);
    }
    
    .category-title {
      display: flex;
      align-items: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 2px solid #eee;
      flex-wrap: wrap;
    }
    
    .category-title h2 {
      font-size: clamp(1.5rem, 4vw, 1.8rem);
      color: #2a5f8a;
      margin-right: 15px;
      font-weight: 600;
    }
    
    .category-title .view-all {
      margin-left: auto;
      color: #2a5f8a;
      font-size: 0.95rem;
      text-decoration: none;
      display: flex;
      align-items: center;
      white-space: nowrap;
      font-weight: 500;
      transition: all 0.3s;
      padding: 8px 16px;
      border-radius: 6px;
      background: #f0f7ff;
    }
    
    .category-title .view-all:hover {
      background: #e1f0ff;
      transform: translateX(5px);
    }
    
    .category-title .view-all i {
      margin-left: 5px;
      font-size: 0.8rem;
      transition: transform 0.3s;
    }
    
    .category-title .view-all:hover i {
      transform: translateX(3px);
    }
    
    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 25px;
    }
    
    .product-card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08);
      transition: transform 0.3s, box-shadow 0.3s;
      text-decoration: none;
      color: inherit;
      display: block;
      border: 1px solid #f0f0f0;
    }
    
    .product-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 15px 30px rgba(0,0,0,0.12);
    }
    
    .product-image {
      height: 200px;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f8fafc;
      padding: 20px;
    }
    
    .product-image img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      transition: transform 0.5s;
    }
    
    .product-card:hover .product-image img {
      transform: scale(1.05);
    }
    
    .product-info {
      padding: 20px;
    }
    
    .product-name {
      font-size: 1.1rem;
      margin-bottom: 12px;
      color: #333;
      font-weight: 600;
      line-height: 1.3;
    }
    
    .product-price {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
      flex-wrap: wrap;
      gap: 8px;
    }
    
    .current-price {
      font-size: 1.2rem;
      color: #e63946;
      font-weight: bold;
      margin-right: 10px;
    }
    
    .original-price {
      text-decoration: line-through;
      color: #999;
      font-size: 0.95rem;
    }
    
    .discount-badge {
      background: #e63946;
      color: white;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
    }
    
    .product-category {
      display: inline-block;
      background: #f0f7ff;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 0.85rem;
      color: #2a5f8a;
      margin-top: 10px;
      font-weight: 500;
      border: 1px solid #d0e6ff;
    }
    
    .view-more-btn {
      display: block;
      text-align: center;
      margin: 40px auto;
      padding: 14px 30px;
      background: #2a5f8a;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s;
      max-width: 250px;
      font-weight: 500;
      box-shadow: 0 4px 15px rgba(42, 95, 138, 0.2);
    }
    
    .view-more-btn:hover {
      background: #1d4567;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(42, 95, 138, 0.3);
    }

    .no-products {
      grid-column: 1 / -1;
      text-align: center;
      padding: 40px;
      color: #666;
      font-size: 1.1rem;
      background: #f8f9fa;
      border-radius: 8px;
      border: 1px dashed #ddd;
    }
    
    /* Loading animation */
    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 40px;
      grid-column: 1 / -1;
    }
    
    .loading::after {
      content: '';
      width: 40px;
      height: 40px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #2a5f8a;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Responsive Styles */
    @media (max-width: 1024px) {
      .main {
        padding: 0 4%;
      }
      
      .products-grid {
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
        gap: 20px;
      }
    }
    
    @media (max-width: 768px) {
      nav {
        flex-direction: row;
        justify-content: space-between;
        padding: 0 10px;
      }
      
      nav > ul {
        position: fixed;
        top: 0;
        right: -100%;
        width: 80%;
        max-width: 300px;
        height: 100vh;
        background-color: white;
        flex-direction: column;
        align-items: flex-start;
        padding: 80px 20px 20px;
        gap: 0;
        transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 999;
        box-shadow: -5px 0 25px rgba(0, 0, 0, 0.15);
        overflow-y: auto;
      }
      
      nav > ul.active {
        right: 0;
      }
      
      nav > ul li {
        width: 100%;
        padding: 0;
        margin: 0;
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        justify-content: flex-start;
      }
      
      nav > ul li a {
        width: 100%;
        padding: 16px 20px;
        text-align: left;
        font-size: 16px;
        font-weight: 500;
      }
      
      .mobile-menu-btn {
        display: block;
      }
      
      .main {
        padding: 0 15px;
      }
      
      .categories-header {
        padding: 30px 0;
      }
      
      .categories-header h1 {
        font-size: 1.8rem;
      }
      
      .categories-header p {
        font-size: 1rem;
      }
      
      .category-section {
        margin: 30px 0;
        padding: 15px;
      }
      
      .products-grid {
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
        gap: 15px;
      }
      
      .product-image {
        height: 160px;
        padding: 15px;
      }
      
      .product-info {
        padding: 15px;
      }
      
      .category-title {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }
      
      .category-title .view-all {
        margin-left: 0;
        align-self: flex-start;
      }
      
      .product-dropdown {
        position: static;
        box-shadow: none;
        border-radius: 0;
        display: none;
        opacity: 1;
        transform: none;
        width: 100%;
        margin-top: 5px;
        border: 1px solid #eee;
      }
      
      .nav-product:hover .product-dropdown {
        display: block;
      }
      
      .nav-product svg {
        margin-left: auto;
      }
    }
    
    @media (max-width: 480px) {
      nav {
        height: 60px;
      }
      
      nav img {
        width: 120px;
      }
      
      .main {
        padding: 0 10px;
      }
      
      .categories-header {
        padding: 25px 0;
      }
      
      .categories-header h1 {
        font-size: 1.6rem;
      }
      
      .category-section {
        margin: 25px 0;
        padding: 15px;
      }
      
      .products-grid {
        grid-template-columns: 1fr;
        gap: 15px;
      }
      
      .product-image {
        height: 180px;
      }
      
      .product-name {
        font-size: 1rem;
      }
      
      .current-price {
        font-size: 1.1rem;
      }
      
      .view-more-btn {
        width: 100%;
        max-width: none;
        padding: 16px;
        font-size: 1rem;
      }
      
      .category-title h2 {
        font-size: 1.4rem;
      }
      
      .nav > ul {
        padding: 70px 15px 20px;
      }
    }
    
    @media (max-width: 360px) {
      .categories-header h1 {
        font-size: 1.4rem;
      }
      
      .product-image {
        height: 150px;
        padding: 10px;
      }
      
      .product-info {
        padding: 12px;
      }
      
      .product-name {
        font-size: 0.95rem;
      }
      
      .current-price {
        font-size: 1rem;
      }
    }
    
    /* Touch-friendly improvements */
    @media (hover: none) and (pointer: coarse) {
      .product-card,
      .view-all,
      .view-more-btn {
        min-height: 44px;
      }
      
      .product-card:active {
        transform: scale(0.98);
      }
      
      .view-all:active,
      .view-more-btn:active {
        transform: scale(0.98);
      }
      
      .product-dropdown a {
        padding: 12px 20px;
        min-height: 44px;
      }
    }
    
    /* Animation for category sections */
    .category-section {
      animation: fadeInUp 0.6s ease-out;
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    /* Category icons */
    .category-icon {
      font-size: 1.5rem;
      margin-right: 10px;
      color: #2a5f8a;
    }
  </style>
</head>
<body>
  <nav>
    <a href="index.html">
      <img src="./Create_a_logo_concep-removebg-preview.png" alt="Damodar Traders Logo">
    </a>
    
    <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Toggle menu">
      <i class="fas fa-bars"></i>
    </button>
    
    <div class="nav-overlay" id="navOverlay"></div>
    
    <ul id="navMenu">
      <li><a href="index.html">Home</a></li>
      <li class="nav-product">
        <a href="categories.html">Products</a>
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M18.2197 8.546L12.2531 14.5126C12.1555 14.6102 11.9972 14.6102 11.8996 14.5126L6.02767 8.64067C5.73477 8.34778 5.2599 8.34778 4.96701 8.64067C4.67411 8.93357 4.67411 9.40844 4.96701 9.70133L10.8389 15.5732C11.5223 16.2566 12.6304 16.2566 13.3138 15.5732L19.2803 9.60666C19.5732 9.31377 19.5732 8.8389 19.2803 8.546C18.9874 8.25311 18.5126 8.25311 18.2197 8.546Z"
            fill="currentColor"></path>
        </svg>
        <div class="product-dropdown">
          <a href="categories.html">All Categories</a>
          <a href="categories.html?category=pipes">Pipes</a>
          <a href="categories.html?category=fittings">Fittings</a>
          <a href="categories.html?category=valves">Valves</a>
          <a href="categories.html?category=other">Other Products</a>
        </div>
      </li>
      <li><a href="about.html">About Us</a></li>
      <li><a href="contact.html">Contact us</a></li>
    </ul>
  </nav>

  <hr class="line">

  <div class="main">
    <div class="categories-header">
      <h1>Our Product Categories</h1>
      <p>Explore our wide range of high-quality industrial products designed to meet your specific needs.</p>
    </div>

    <div class="category-section" id="pipes-section">
      <div class="category-title">
        <h2><i class="fas fa-pipe category-icon"></i> Pipes</h2>
        <a href="categories.html?category=pipes" class="view-all">
          View all pipes <i class="fas fa-chevron-right"></i>
        </a>
      </div>
      <div class="products-grid" id="pipes-grid">
        <div class="loading"></div>
      </div>
    </div>

    <div class="category-section" id="fittings-section">
      <div class="category-title">
        <h2><i class="fas fa-link category-icon"></i> Fittings</h2>
        <a href="categories.html?category=fittings" class="view-all">
          View all fittings <i class="fas fa-chevron-right"></i>
        </a>
      </div>
      <div class="products-grid" id="fittings-grid">
        <div class="loading"></div>
      </div>
    </div>

    <div class="category-section" id="valves-section">
      <div class="category-title">
        <h2><i class="fas fa-faucet category-icon"></i> Valves</h2>
        <a href="categories.html?category=valves" class="view-all">
          View all valves <i class="fas fa-chevron-right"></i>
        </a>
      </div>
      <div class="products-grid" id="valves-grid">
        <div class="loading"></div>
      </div>
    </div>

    <div class="category-section" id="other-section">
      <div class="category-title">
        <h2><i class="fas fa-tools category-icon"></i> Other Products</h2>
        <a href="categories.html?category=other" class="view-all">
          View all other products <i class="fas fa-chevron-right"></i>
        </a>
      </div>
      <div class="products-grid" id="other-grid">
        <div class="loading"></div>
      </div>
    </div>

    <button class="view-more-btn" id="viewMoreBtn">View More Products</button>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Mobile menu functionality
      const mobileMenuBtn = document.getElementById('mobileMenuBtn');
      const navMenu = document.getElementById('navMenu');
      const navOverlay = document.getElementById('navOverlay');

      mobileMenuBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        navMenu.classList.toggle('active');
        navOverlay.classList.toggle('active');
      });

      navOverlay.addEventListener('click', () => {
        navMenu.classList.remove('active');
        navOverlay.classList.remove('active');
        // Close dropdowns
        document.querySelectorAll('.nav-product').forEach(item => {
          item.classList.remove('active');
        });
      });

      // Toggle product dropdown on mobile
      const navProducts = document.querySelectorAll('.nav-product');
      navProducts.forEach(item => {
        const link = item.querySelector('a');
        
        link.addEventListener('click', (e) => {
          if (window.innerWidth <= 768) {
            e.preventDefault();
            e.stopPropagation();
            
            // Close other open dropdowns
            navProducts.forEach(otherItem => {
              if (otherItem !== item && otherItem.classList.contains('active')) {
                otherItem.classList.remove('active');
              }
            });
            
            // Toggle current dropdown
            item.classList.toggle('active');
          }
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
          if (window.innerWidth <= 768 && !item.contains(e.target)) {
            item.classList.remove('active');
          }
        });
      });

      // Close mobile menu when clicking on a link
      document.querySelectorAll('#navMenu a').forEach(link => {
        link.addEventListener('click', (e) => {
          if (window.innerWidth <= 768) {
            // Only close if it's not a dropdown toggle
            if (!e.target.closest('.nav-product > a')) {
              navMenu.classList.remove('active');
              navOverlay.classList.remove('active');
            }
          }
        });
      });

      const API_BASE_URL = 'https://dttt-5.onrender.com/api';
      const urlParams = new URLSearchParams(window.location.search);
      const category = urlParams.get('category');
      const showAll = urlParams.get('showAll');
      const defaultImage = "assets/Screenshot_2025-06-19_201249-removebg-preview.png";
      
      // If a specific category is selected, show only that category
      if (category) {
        document.querySelectorAll('.category-section').forEach(section => {
          const sectionId = section.id.replace('-section', '');
          if (sectionId !== category) {
            section.style.display = 'none';
          }
        });
        document.getElementById('viewMoreBtn').style.display = 'none';
        document.querySelector('.categories-header h1').textContent = `${category.charAt(0).toUpperCase() + category.slice(1)} Products`;
        document.querySelector('.categories-header p').textContent = `Browse our collection of high-quality ${category} products.`;
      }

      // Load products with better error handling
      async function loadProducts() {
        let products = [];
        
        try {
          // Show loading state
          showLoadingState();
          
          // Try to load from localStorage first
          const storedProducts = localStorage.getItem('productDetails');
          if (storedProducts) {
            const parsedProducts = JSON.parse(storedProducts);
            if (Array.isArray(parsedProducts) && parsedProducts.length > 0) {
              products = parsedProducts;
              displayProducts(products);
            }
          }

          // Then try to fetch from API
          let endpoint = '/products';
          if (category) {
            endpoint = `/products/category/${category}`;
          }

          const response = await fetch(`${API_BASE_URL}${endpoint}`, {
            headers: {
              'Content-Type': 'application/json',
            },
            credentials: 'include'
          });

          if (!response.ok) {
            throw new Error(`API request failed with status ${response.status}`);
          }

          const apiProducts = await response.json();
          
          if (Array.isArray(apiProducts) && apiProducts.length > 0) {
            products = apiProducts;
            // Store in localStorage for future use
            localStorage.setItem('productDetails', JSON.stringify(products));
          }
        } catch (error) {
          console.error('Error loading products:', error);
          // If no products loaded yet, use fallback
          if (products.length === 0) {
            products = getFallbackProducts();
          }
        } finally {
          displayProducts(products);
        }
      }

      function getFallbackProducts() {
        return [
          {
            _id: '1',
            name: 'High-Quality PVC Pipe',
            category: 'pipes',
            description: 'Premium PVC pipe for industrial use',
            image: 'https://images.unsplash.com/photo-1581092580497-e0d4cb184827?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80',
            sizeOptions: [{ size: '1 inch', price: 150 }, { size: '2 inch', price: 250 }],
            discount: 0
          },
          {
            _id: '2',
            name: '90-Degree Elbow Fitting',
            category: 'fittings',
            description: 'High-grade elbow fitting for pipe connections',
            image: 'https://images.unsplash.com/photo-1581092580497-e0d4cb184827?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80',
            sizeOptions: [{ size: '1/2 inch', price: 45 }, { size: '3/4 inch', price: 60 }],
            discount: 0
          },
          {
            _id: '3',
            name: 'Industrial Ball Valve',
            category: 'valves',
            description: 'Durable ball valve for precise fluid control',
            image: 'https://images.unsplash.com/photo-1581092580497-e0d4cb184827?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80',
            sizeOptions: [{ size: '1 inch', price: 120 }, { size: '2 inch', price: 200 }],
            discount: 10
          },
          {
            _id: '4',
            name: 'Stainless Steel Pipe Clamp',
            category: 'other',
            description: 'Sturdy pipe clamp for secure installations',
            image: 'https://images.unsplash.com/photo-1581092580497-e0d4cb184827?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80',
            sizeOptions: [{ size: 'Standard', price: 25 }],
            discount: 0
          }
        ];
      }

      function showLoadingState() {
        document.querySelectorAll('.products-grid').forEach(grid => {
          grid.innerHTML = '<div class="loading"></div>';
        });
      }

      function displayProducts(products) {
        if (!products || !Array.isArray(products)) {
          showErrorMessage('Invalid product data received');
          return;
        }

        if (products.length === 0) {
          showNoProductsMessage();
          return;
        }

        // Group products by category
        const productsByCategory = {
          pipes: [],
          fittings: [],
          valves: [],
          other: []
        };

        products.forEach(product => {
          const productCategory = (product.category?.toLowerCase() || 'other');
          if (productsByCategory[productCategory]) {
            productsByCategory[productCategory].push(product);
          } else {
            productsByCategory.other.push(product);
          }
        });

        // Display products in their respective sections
        for (const [category, categoryProducts] of Object.entries(productsByCategory)) {
          const gridElement = document.getElementById(`${category}-grid`);
          if (!gridElement) continue;

          gridElement.innerHTML = '';
          
          // Determine how many products to show
          let productsToShow = categoryProducts;
          if (!showAll && !category) {
            productsToShow = categoryProducts.slice(0, 4);
          }
          
          if (productsToShow.length === 0) {
            gridElement.innerHTML = '<div class="no-products">No products available in this category</div>';
            continue;
          }

          productsToShow.forEach(product => {
            const productCard = createProductCard(product);
            gridElement.appendChild(productCard);
          });
        }

        // Show/hide view more button
        updateViewMoreButton();
      }

      function createProductCard(product) {
        const productCard = document.createElement('a');
        productCard.href = `product-details.html?id=${product._id}`;
        productCard.className = 'product-card';
        productCard.setAttribute('aria-label', `View ${product.name || 'product'}`);
        
        // Product image
        const productImage = document.createElement('div');
        productImage.className = 'product-image';
        const img = document.createElement('img');
        img.src = product.image || product.imagePath || defaultImage;
        img.alt = product.name || 'Product Image';
        img.loading = "lazy";
        img.decoding = "async";
        img.onerror = function() {
          this.src = defaultImage;
        };
        productImage.appendChild(img);
        
        // Product info
        const productInfo = document.createElement('div');
        productInfo.className = 'product-info';
        
        const productName = document.createElement('h3');
        productName.className = 'product-name';
        productName.textContent = product.name || 'Unnamed Product';
        
        const productPrice = document.createElement('div');
        productPrice.className = 'product-price';
        
        // Get the first available price if sizeOptions exist
        let price = 0;
        if (product.sizeOptions && product.sizeOptions.length > 0 && product.sizeOptions[0].price) {
          price = product.sizeOptions[0].price;
        }
        
        if (price > 0) {
          const currentPrice = document.createElement('span');
          currentPrice.className = 'current-price';
          
          if (product.discount && product.discount > 0) {
            const discountedPrice = price * (1 - product.discount/100);
            currentPrice.textContent = `₹${discountedPrice.toFixed(2)}`;
            
            const originalPrice = document.createElement('span');
            originalPrice.className = 'original-price';
            originalPrice.textContent = `₹${price.toFixed(2)}`;
            
            const discountBadge = document.createElement('span');
            discountBadge.className = 'discount-badge';
            discountBadge.textContent = `${product.discount}% OFF`;
            
            productPrice.appendChild(originalPrice);
            productPrice.appendChild(currentPrice);
            productPrice.appendChild(discountBadge);
          } else {
            currentPrice.textContent = `₹${price.toFixed(2)}`;
            productPrice.appendChild(currentPrice);
          }
        } else {
          const priceText = document.createElement('span');
          priceText.textContent = 'Price on request';
          priceText.style.color = '#666';
          productPrice.appendChild(priceText);
        }
        
        const productCategory = document.createElement('span');
        productCategory.className = 'product-category';
        productCategory.textContent = product.category ? 
          product.category.charAt(0).toUpperCase() + product.category.slice(1) : 
          'Other';
        
        productInfo.appendChild(productName);
        productInfo.appendChild(productPrice);
        productInfo.appendChild(productCategory);
        
        productCard.appendChild(productImage);
        productCard.appendChild(productInfo);
        
        // Add touch feedback for mobile
        if ('ontouchstart' in window) {
          productCard.addEventListener('touchstart', function() {
            this.style.transform = 'scale(0.98)';
          });
          productCard.addEventListener('touchend', function() {
            this.style.transform = '';
          });
        }
        
        return productCard;
      }

      function showErrorMessage(message) {
        const header = document.querySelector('.categories-header');
        if (!header) return;
        
        const errorElement = document.createElement('p');
        errorElement.style.textAlign = 'center';
        errorElement.style.padding = '20px';
        errorElement.style.color = '#e63946';
        errorElement.style.backgroundColor = '#ffe6e6';
        errorElement.style.borderRadius = '8px';
        errorElement.style.marginTop = '20px';
        errorElement.textContent = message;
        
        header.appendChild(errorElement);
      }

      function showNoProductsMessage() {
        document.querySelectorAll('.products-grid').forEach(grid => {
          grid.innerHTML = '<div class="no-products">No products available at the moment. Please check back later.</div>';
        });
      }

      function updateViewMoreButton() {
        const viewMoreBtn = document.getElementById('viewMoreBtn');
        if (category || showAll) {
          viewMoreBtn.style.display = 'none';
        } else {
          viewMoreBtn.style.display = 'block';
        }
      }

      // View more button functionality
      document.getElementById('viewMoreBtn').addEventListener('click', function() {
        window.location.href = 'categories.html?showAll=true';
      });

      // Add touch feedback for view more button
      if ('ontouchstart' in window) {
        const viewMoreBtn = document.getElementById('viewMoreBtn');
        viewMoreBtn.addEventListener('touchstart', function() {
          this.style.transform = 'scale(0.98)';
        });
        viewMoreBtn.addEventListener('touchend', function() {
          this.style.transform = '';
        });
      }

      // Initialize
      loadProducts();
    });
  </script>
</body>
</html>
